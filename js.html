<script>
  const app = Vue.createApp({
    data: ()=>({
      searchWords: "",
      items: null,
      // ヘッダ―情報　サーバサイドにも渡すけどここにベタ書きしてるのはなんか違う気がする
      tableHeader: ["本の名前", "人名", "出版者", "分類"],
      sheetHeader: [
        "title", "author", "publisher", "genre", 
      ],
      message: "",
    }),
    methods: {
      addItem: function(event){
        console.log("CLICK")
      },
      loadData: async function(event){
        this.message = "けんさくちゅう..."
        let sheetData = null;
        sheetData = await this.searchData();
        this.message = "けんさくけっか！";
        this.items = sheetData;
        console.log(`items`);
        console.log(this.items);
      },
      getData: function(){
        return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((result) => resolve(result))
          .withFailureHandler((error) => resolve(error))
          .getAllData(this.sheetHeader);
        });
      },
      searchData: function(){
        return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((result) => resolve(result))
          .withFailureHandler((error) => resolve(error))
          .search(this.sheetHeader, this.searchWords);
        });
      },


    },
  });


  app.mount("#app")
</script>
