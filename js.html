<script>
  const app = Vue.createApp({
    data: ()=>({
      searchWords: '',
      items: null,
      tableHeader: [
        // {"title": "本の名前"},
        // {"author":"著者"},
        // {"genre": "分類"},
        // {"publisher": "出版社"},
        // {"is_rented": "貸出状況"},
        // {"image": "画像URL"},
        "本の名前", "著者", "分類", "出版社", "貸出状況", "画像URL"
      ]
    }),
    methods: {
      addItem: function(event){
        console.log("CLICK")
      },
      loadData: async function(event){
        let sheetData = null;
        if(this.searchWords === ""){
          sheetData = await this.getData();
        }else{
          sheetData = await this.searchData();
        }
        // なぜかsearchWordsがないと言われた
        // sheetData = await this.searchData();
        this.items = sheetData;
        console.log(`items`);
        console.log(this.items);
      },
      getData: function(){
        return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((result) => resolve(result))
          .withFailureHandler((error) => resolve(error))
          .getAllData();
        });
      },
      searchData: function(){
        return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((result) => resolve(result))
          .withFailureHandler((error) => resolve(error))
          .search(this.searchWords);
        });
      },


    },
  });


  app.mount("#app")
</script>
