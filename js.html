<script>
  const app = Vue.createApp({
    data: ()=>({
      searchWords: '',
      items: null,
      tableHeader: ["本の名前", "人名", "出版社", "分類"],
      sheetHeader: [
        "title", "author", "publisher", "genre", 
      ],
    }),
    methods: {
      addItem: function(event){
        console.log("CLICK")
      },
      loadData: async function(event){
        let sheetData = null;
        if(this.searchWords === ""){
          sheetData = await this.getData();
        }else{
          sheetData = await this.searchData();
        }
        this.items = sheetData;
        console.log(`items`);
        console.log(this.items);
      },
      getData: function(){
        return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((result) => resolve(result))
          .withFailureHandler((error) => resolve(error))
          .getAllData(this.sheetHeader);
        });
      },
      searchData: function(){
        return new Promise((resolve, reject) => {
        google.script.run
          .withSuccessHandler((result) => resolve(result))
          .withFailureHandler((error) => resolve(error))
          .search(this.sheetHeader, this.searchWords);
        });
      },


    },
  });


  app.mount("#app")
</script>
